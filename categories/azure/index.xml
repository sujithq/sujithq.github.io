<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Azure | Sujith Quintelier</title><link>/categories/azure/</link><atom:link href="/categories/azure/index.xml" rel="self" type="application/rss+xml"/><description>Azure</description><generator>Source Themes Academic (https://sourcethemes.com/academic/)</generator><language>en-us</language><copyright>©2023</copyright><lastBuildDate>Mon, 20 Mar 2023 06:00:00 +0000</lastBuildDate><image><url>/img/Quintelier_Sujith</url><title>Azure</title><link>/categories/azure/</link></image><item><title>Azure Storage redundancy</title><link>/post/2023-03-20-lrs-zrs-ra-grs-ra-gzrs/</link><pubDate>Mon, 20 Mar 2023 06:00:00 +0000</pubDate><guid>/post/2023-03-20-lrs-zrs-ra-grs-ra-gzrs/</guid><description>&lt;p>Azure Storage always stores multiple copies of your data so that it&amp;rsquo;s protected from planned and unplanned events, including transient hardware failures, network or power outages, and massive natural disasters. Redundancy ensures that your storage account meets its availability and durability targets even in the face of failures.&lt;/p>
&lt;h2 id="redundancy-primary-region">Redundancy Primary Region&lt;/h2>
&lt;p>Data in an Azure Storage account is always replicated three times in the primary region. Azure Storage offers two options for how your data is replicated in the primary region:&lt;/p>
&lt;ul>
&lt;li>LRS&lt;/li>
&lt;li>ZRS&lt;/li>
&lt;/ul>
&lt;h3 id="lrs">LRS&lt;/h3>
&lt;p>Copies your data &lt;strong>synchronously&lt;/strong> three times within a single physical location in the primary region. LRS is the least expensive replication option, but isn&amp;rsquo;t recommended for applications requiring high availability or durability.&lt;/p>
&lt;p>&lt;img src="img/lrs.png" alt="lrs">&lt;/p>
&lt;h3 id="zrs">ZRS&lt;/h3>
&lt;p>Copies your data &lt;strong>synchronously&lt;/strong> across three Azure availability zones in the primary region. For applications requiring high availability, Microsoft recommends using ZRS in the primary region, and also replicating to a secondary region.&lt;/p>
&lt;p>&lt;img src="img/zrs.png" alt="zrs">&lt;/p>
&lt;h2 id="redundancy-secondary-region">Redundancy Secondary Region&lt;/h2>
&lt;p>For applications requiring high durability, you can choose to additionally copy the data in your storage account to a secondary region that is hundreds of miles away from the primary region. If your storage account is copied to a secondary region, then your data is durable even in the case of a complete regional outage or a disaster in which the primary region isn&amp;rsquo;t recoverable.&lt;/p>
&lt;p>When you create a storage account, you select the primary region for the account. The paired secondary region is determined based on the primary region, and can&amp;rsquo;t be changed.&lt;/p>
&lt;p>Azure Storage offers two options for copying your data to a secondary region:&lt;/p>
&lt;ul>
&lt;li>GRS&lt;/li>
&lt;li>GZRS&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>The primary difference between GRS and GZRS is how data is replicated in the primary region. Within the secondary region, data is always replicated synchronously three times using LRS. LRS in the secondary region protects your data against hardware failures.&lt;/p>
&lt;/blockquote>
&lt;h3 id="grs">GRS&lt;/h3>
&lt;p>Copies your data synchronously three times within a single physical location in the primary region using LRS. It then copies your data asynchronously to a single physical location in the secondary region. Within the secondary region, your data is copied synchronously three times using LRS.&lt;/p>
&lt;p>&lt;img src="img/ra-grs.png" alt="grs">&lt;/p>
&lt;h3 id="gzrs">GZRS&lt;/h3>
&lt;p>Copies your data synchronously across three Azure availability zones in the primary region using ZRS. It then copies your data asynchronously to a single physical location in the secondary region. Within the secondary region, your data is copied synchronously three times using LRS.&lt;/p>
&lt;p>&lt;img src="img/ra-gzrs.png" alt="gzrs">&lt;/p>
&lt;h3 id="read-access-to-data-in-the-secondary-region">Read access to data in the secondary region&lt;/h3>
&lt;p>Geo-redundant storage (with GRS or GZRS) replicates your data to another physical location in the secondary region to protect against regional outages. With an account configured for GRS or GZRS, data in the secondary region is not directly accessible to users or applications, unless a failover occurs. The failover process updates the DNS entry provided by Azure Storage so that the secondary endpoint becomes the new primary endpoint for your storage account. During the failover process, your data is inaccessible. After the failover is complete, you can read and write data to the new primary region.&lt;/p>
&lt;p>If your applications require high availability, then you can configure your storage account for read access to the secondary region. When you enable read access to the secondary region, then your data is always available to be read from the secondary, including in a situation where the primary region becomes unavailable. Read-access geo-redundant storage (RA-GRS) or read-access geo-zone-redundant storage (RA-GZRS) configurations permit read access to the secondary region.&lt;/p>
&lt;blockquote>
&lt;p>Because data is replicated asynchronously from the primary to the secondary region, the secondary region is typically behind the primary region in terms of write operations. If a disaster were to strike the primary region, it&amp;rsquo;s likely that some data would be lost.&lt;/p>
&lt;/blockquote>
&lt;h2 id="summaries">Summaries&lt;/h2>
&lt;h3 id="durability-and-availability-parameters">Durability and availability parameters&lt;/h3>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Parameter&lt;/th>
&lt;th>LRS&lt;/th>
&lt;th>ZRS&lt;/th>
&lt;th>(RA-)GRS&lt;/th>
&lt;th>(RA-)GZRS&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Percent durability of objects over a given year&lt;/td>
&lt;td>at least 11 9&amp;rsquo;s&lt;/td>
&lt;td>at least 12 9&amp;rsquo;s&lt;/td>
&lt;td>at least 16 9&amp;rsquo;s&lt;/td>
&lt;td>at least 16 9&amp;rsquo;s&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Availability for read requests&lt;/td>
&lt;td>At least 99.9% (99% for Cool or Archive access tiers)&lt;/td>
&lt;td>At least 99.9% (99% for Cool or Archive access tiers)&lt;/td>
&lt;td>At least 99.9% (99% for Cool or Archive access tiers) for GRS&lt;/td>
&lt;td>At least 99.99% (99.9% for Cool or Archive access tiers) for RA-GRS&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;/td>
&lt;td>&lt;/td>
&lt;td>&lt;/td>
&lt;td>At least 99.9% (99% for Cool or Archive access tiers) for GZRS&lt;/td>
&lt;td>At least 99.99% (99.9% for Cool or Archive access tiers) for RA-GZRS&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Availability for write requests&lt;/td>
&lt;td>At least 99.9% (99% for Cool or Archive access tiers)&lt;/td>
&lt;td>At least 99.9% (99% for Cool or Archive access tiers)&lt;/td>
&lt;td>At least 99.9% (99% for Cool or Archive access tiers)&lt;/td>
&lt;td>At least 99.9% (99% for Cool or Archive access tiers)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Number of copies of data maintained on separate nodes&lt;/td>
&lt;td>Three copies within a single region&lt;/td>
&lt;td>Three copies across separate availability zones within a single region&lt;/td>
&lt;td>Six copies total, including three in the primary region and three in the secondary region&lt;/td>
&lt;td>Six copies total, including three across separate availability zones in the primary region and three locally redundant copies in the secondary region&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h3 id="durability-and-availability-by-outage-scenario">Durability and availability by outage scenario&lt;/h3>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Parameter&lt;/th>
&lt;th>LRS&lt;/th>
&lt;th>ZRS&lt;/th>
&lt;th>(RA-)GRS&lt;/th>
&lt;th>(RA-)GZRS&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>A node within a data center becomes unavailable&lt;/td>
&lt;td>Yes&lt;/td>
&lt;td>Yes&lt;/td>
&lt;td>Yes&lt;/td>
&lt;td>Yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>An entire data center (zonal or non-zonal) becomes unavailable&lt;/td>
&lt;td>No&lt;/td>
&lt;td>Yes&lt;/td>
&lt;td>Yes&lt;/td>
&lt;td>Yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>A region-wide outage occurs in the primary region&lt;/td>
&lt;td>No&lt;/td>
&lt;td>No&lt;/td>
&lt;td>Yes&lt;/td>
&lt;td>Yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Read access to the secondary region is available if the primary region becomes unavailable&lt;/td>
&lt;td>No&lt;/td>
&lt;td>No&lt;/td>
&lt;td>Yes (with RA-GRS)&lt;/td>
&lt;td>Yes (with RA-GZRS)&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table></description></item><item><title>Azure Load Balancing options</title><link>/post/2022-06-17-azure-load-balancing-options/</link><pubDate>Fri, 17 Jun 2022 06:00:00 +0000</pubDate><guid>/post/2022-06-17-azure-load-balancing-options/</guid><description>&lt;p>The term load balancing refers to the even distribution of workloads (that is, incoming network traffic), across a group of backend computing resources or servers. Load balancing aims to optimize resource use, maximize throughput, minimize response time, and avoid overloading any single resource. It can also improve availability by sharing a workload across redundant computing resources.&lt;/p>
&lt;h2 id="options">Options&lt;/h2>
&lt;ul>
&lt;li>Azure Load Balancer&lt;/li>
&lt;li>Traffic Manager&lt;/li>
&lt;li>Azure Application Gateway&lt;/li>
&lt;li>Azure Front Door&lt;/li>
&lt;/ul>
&lt;h3 id="azure-load-balancer">Azure Load Balancer&lt;/h3>
&lt;p>&lt;img src="img/azure-load-balancer.png" alt="Azure Load Balancer">&lt;/p>
&lt;p>High-performance, ultra-low-latency &lt;strong>Layer 4&lt;/strong> load-balancing service (inbound and outbound) for all &lt;strong>UDP&lt;/strong> and &lt;strong>TCP&lt;/strong> protocols. It is built to handle millions of requests per second while ensuring your solution is highly available. Azure Load Balancer is &lt;strong>zone-redundant&lt;/strong>, ensuring high availability across &lt;strong>Availability Zones&lt;/strong>.&lt;/p>
&lt;h4 id="type">Type&lt;/h4>
&lt;p>They can be public (aka external) or internal (aka private).&lt;/p>
&lt;p>&lt;strong>Public&lt;/strong> - Provide outbound connections for virtual machines (VMs) inside your virtual network. These connections are accomplished by translating their private IP addresses to public IP addresses. External load balancers are used to distribute client traffic from the internet across your VMs. That internet traffic might come from web browsers, module apps, or other sources.&lt;/p>
&lt;p>&lt;strong>Internal&lt;/strong> - Is used where private IPs are needed at the frontend only. Internal load balancers are used to load balance traffic from internal Azure resources to other Azure resources inside a virtual network. A load balancer frontend can also be accessed from an on-premises network in a hybrid scenario.&lt;/p>
&lt;p>&lt;img src="img/alb-public-internal.png" alt="ALB Public vs Internal">&lt;/p>
&lt;h4 id="availability-zones">Availability zones&lt;/h4>
&lt;p>Azure Load Balancer can be either zone redundant, zonal or non-zonal.&lt;/p>
&lt;p>&lt;strong>Zone redundant&lt;/strong> - The traffic s served by a single IP address and it survives zone failure. The frontend IP may be used to reach all non-impacted backend pool members no matter the zone. One or more availability zones can fail and the data path survives as long as one zone in the region remains healthy.&lt;/p>
&lt;p>&lt;img src="img/alb-zone-redundant.png" alt="ALB Zone Redundant">&lt;/p>
&lt;p>&lt;strong>Zonal&lt;/strong> - The frontend is guaranteed to a single zone. Any inbound or outbound flow is served by a single zone in a region. Your frontend shares fate with the health of the zone. The data path is unaffected by failures in zones other than where it was guaranteed. You can use zonal front-ends to expose an IP address per Availability Zone.&lt;/p>
&lt;p>Additionally, the use of zonal front-ends directly for load balanced endpoints within each zone is supported. You can use this configuration to expose per zone load-balanced endpoints to individually monitor each zone. For public endpoints, you can integrate them with a DNS load-balancing product like Traffic Manager and use a single DNS name.&lt;/p>
&lt;p>&lt;img src="img/alb-zonal.png" alt="ALB Zonal">&lt;/p>
&lt;h4 id="sku">SKU&lt;/h4>
&lt;p>There are 2 SKUs available: Standard and basic.&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Features&lt;/th>
&lt;th>Standard Load Balancer&lt;/th>
&lt;th>Basic Load Balancer&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Backend pool size&lt;/td>
&lt;td>Supports up to 1000 instances.&lt;/td>
&lt;td>Supports up to 300 instances.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Backend pool endpoints&lt;/td>
&lt;td>Any virtual machines or virtual machine scale sets in a single virtual network.&lt;/td>
&lt;td>Virtual machines in a single availability set or virtual machine scale set.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Health probes&lt;/td>
&lt;td>TCP, HTTP, HTTPS&lt;/td>
&lt;td>TCP, HTTP&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Health probe down behavior&lt;/td>
&lt;td>TCP connections stay alive on an instance probe down and on all probes down.&lt;/td>
&lt;td>TCP connections stay alive on an instance probe down. All TCP connections end when all probes are down.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Availability Zones&lt;/td>
&lt;td>Zone-redundant and zonal front-ends for inbound and outbound traffic.&lt;/td>
&lt;td>Not available&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Diagnostics&lt;/td>
&lt;td>Azure Monitor multi-dimensional metrics&lt;/td>
&lt;td>Azure Monitor logs&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>HA Ports&lt;/td>
&lt;td>Available for Internal Load Balancer&lt;/td>
&lt;td>Not available&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Secure by default&lt;/td>
&lt;td>Closed to inbound flows unless allowed by a network security group. Internal traffic from the virtual network to the internal load balancer is allowed.&lt;/td>
&lt;td>Open by default. Network security group optional.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Outbound Rules&lt;/td>
&lt;td>Declarative outbound NAT configuration&lt;/td>
&lt;td>Not available&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>TCP Reset on Idle&lt;/td>
&lt;td>Available on any rule&lt;/td>
&lt;td>Not available&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Multiple front ends&lt;/td>
&lt;td>Inbound and outbound&lt;/td>
&lt;td>Inbound only&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Management Operations&lt;/td>
&lt;td>Most operations &amp;lt; 30 seconds&lt;/td>
&lt;td>60-90+ seconds typical&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>SLA&lt;/td>
&lt;td>99.99%&lt;/td>
&lt;td>Not available&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h3 id="traffic-manager">Traffic Manager&lt;/h3>
&lt;p>&lt;img src="img/azure-traffic-manager.png" alt="Azure Traffic Manager">&lt;/p>
&lt;p>&lt;strong>DNS-based&lt;/strong> traffic load balancer that enables you to distribute traffic optimally to services across &lt;strong>global Azure regions&lt;/strong>, while providing high availability and responsiveness. Because Traffic Manager is a DNS-based load-balancing service, it load-balances only at the &lt;strong>domain level&lt;/strong>. For that reason, it can&amp;rsquo;t fail over as quickly as Front Door, because of common challenges around DNS caching and systems not honoring DNS time-to-live values (TTLs).&lt;/p>
&lt;p>&lt;img src="img/tm-setup.png" alt="Azure Traffic Manager Setup">&lt;/p>
&lt;p>&lt;img src="img/tm-working.png" alt="Azure Traffic Manager Working">&lt;/p>
&lt;ol>
&lt;li>
&lt;p>The client sends a DNS query to its configured recursive DNS service to resolve the name ‘partners.contoso.com’. A recursive DNS service, sometimes called a &amp;lsquo;local DNS&amp;rsquo; service, does not host DNS domains directly. Rather, the client off-loads the work of contacting the various authoritative DNS services across the Internet needed to resolve a DNS name.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>To resolve the DNS name, the recursive DNS service finds the name servers for the ‘contoso.com’ domain. It then contacts those name servers to request the &amp;lsquo;partners.contoso.com&amp;rsquo; DNS record. The contoso.com DNS servers return the CNAME record which points to contoso.trafficmanager.net.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Next, the recursive DNS service finds the name servers for the ‘trafficmanager.net’ domain, which are provided by the Azure Traffic Manager service. It then sends a request for the &amp;lsquo;contoso.trafficmanager.net&amp;rsquo; DNS record to those DNS servers.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>The Traffic Manager name servers receive the request. They choose an endpoint based on:&lt;/p>
&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>The configured state of each endpoint (disabled endpoints are not returned)&lt;/li>
&lt;li>The current health of each endpoint, as determined by the Traffic Manager health checks.&lt;/li>
&lt;li>The chosen traffic-routing method.&lt;/li>
&lt;/ul>
&lt;ol start="5">
&lt;li>
&lt;p>The chosen endpoint is returned as another DNS CNAME record. In this case, let us suppose contoso-eu.cloudapp.net is returned.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Next, the recursive DNS service finds the name servers for the ‘cloudapp.net’ domain. It contacts those name servers to request the &amp;lsquo;contoso-eu.cloudapp.net&amp;rsquo; DNS record. A DNS ‘A’ record containing the IP address of the EU-based service endpoint is returned.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>The recursive DNS service consolidates the results and returns a single DNS response to the client.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>The client receives the DNS results and connects to the given IP address. The client connects to the application service endpoint directly, not through Traffic Manager. Since it is an HTTPS endpoint, the client performs the necessary SSL/TLS handshake, and then makes an HTTP GET request for the ‘/login.aspx’ page.&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h4 id="routing-methods">Routing methods&lt;/h4>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Routing method&lt;/th>
&lt;th>When to use&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Priority&lt;/td>
&lt;td>Select this routing method when you want to have a primary service endpoint for all traffic. You can provide multiple backup endpoints in case the primary or one of the backup endpoints is unavailable.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Weighted&lt;/td>
&lt;td>Select this routing method when you want to distribute traffic across a set of endpoints based on their weight. Set the weight the same to distribute evenly across all endpoints.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Performance&lt;/td>
&lt;td>Select the routing method when you have endpoints in different geographic locations, and you want end users to use the &amp;ldquo;closest&amp;rdquo; endpoint for the lowest network latency.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Geographic&lt;/td>
&lt;td>Select this routing method to direct users to specific endpoints (Azure, External, or Nested) based on where their DNS queries originate from geographically. With this routing method, it enables you to be compliant with scenarios such as data sovereignty mandates, localization of content &amp;amp; user experience and measuring traffic from different regions.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>MultiValue&lt;/td>
&lt;td>Select this routing method for Traffic Manager profiles that can only have IPv4/IPv6 addresses as endpoints. When a query is received for this profile, all healthy endpoints are returned.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Subnet&lt;/td>
&lt;td>Select this routing method to map sets of end-user IP address ranges to a specific endpoint. When a request is received, the endpoint returned will be the one mapped for that request’s source IP address.&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>Examples&lt;/p>
&lt;p>&lt;img src="img/tm-priority.png" alt="Azure Traffic Manager Priority">
&lt;img src="img/tm-weighted.png" alt="Azure Traffic Manager Weighted">
&lt;img src="img/tm-performance.png" alt="Azure Traffic Manager Performance">
&lt;img src="img/tm-geo.png" alt="Azure Traffic Manager Geo">&lt;/p>
&lt;p>Profiles can be nested&lt;/p>
&lt;p>&lt;img src="img/tm-nested.png" alt="Azure Traffic Manager Nested">&lt;/p>
&lt;h3 id="azure-application-gateway">Azure Application Gateway&lt;/h3>
&lt;p>&lt;img src="img/azure-application-gateway.png" alt="Azure Application Gateway">&lt;/p>
&lt;p>Provides application delivery controller (ADC) as a service, offering various &lt;strong>Layer 7&lt;/strong> load-balancing capabilities. Use it to optimize web farm productivity by &lt;strong>offloading&lt;/strong> CPU-intensive &lt;strong>SSL termination&lt;/strong> to the gateway.&lt;/p>
&lt;p>Azure Application Gateway is a web traffic load balancer that enables you to manage traffic to your web applications. Traditional load balancers operate at the transport layer (OSI layer 4 - TCP and UDP) and route traffic based on source IP address and port, to a destination IP address and port.&lt;/p>
&lt;p>&lt;img src="img/apg-general.png" alt="Application Gateway Flow">&lt;/p>
&lt;h3 id="azure-front-door">Azure Front Door&lt;/h3>
&lt;p>&lt;img src="img/azure-front-door.png" alt="Azure Front Door">&lt;/p>
&lt;p>Application delivery network that provides &lt;strong>global&lt;/strong> load balancing and site acceleration service for &lt;strong>web applications&lt;/strong>. It offers &lt;strong>Layer 7&lt;/strong> capabilities for your application like &lt;strong>SSL offload&lt;/strong>, &lt;strong>path-based routing&lt;/strong>, fast failover, caching, etc. to improve performance and high-availability of your applications.&lt;/p>
&lt;h2 id="global-vs-regional">Global vs regional&lt;/h2>
&lt;p>&lt;strong>Global&lt;/strong> load-balancing services distribute traffic across regional backends, clouds, or hybrid on-premises services. These services route end-user traffic to the closest available backend. They also react to changes in service reliability or performance, in order to maximize availability and performance. You can think of them as systems that load balance between application stamps, endpoints, or scale-units hosted across different regions/geographies.&lt;/p>
&lt;p>In contrast, &lt;strong>Regional&lt;/strong> load-balancing services distribute traffic within virtual networks across virtual machines (VMs) or zonal and zone-redundant service endpoints within a region. You can think of them as systems that load balance between VMs, containers, or clusters within a region in a virtual network.&lt;/p>
&lt;h2 id="https-vs-non-https">HTTP(S) vs non-HTTP(S)&lt;/h2>
&lt;p>&lt;strong>HTTP(S)&lt;/strong> load-balancing services are Layer 7 load balancers that only accept HTTP(S) traffic. They are intended for web applications or other HTTP(S) endpoints. They include features such as SSL offload, web application firewall, path-based load balancing, and session affinity.&lt;/p>
&lt;p>In contrast, &lt;strong>non-HTTP(S)&lt;/strong> load-balancing services can handle non-HTTP(S) traffic and are recommended for non-web workloads.&lt;/p>
&lt;h2 id="summary">Summary&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Service&lt;/th>
&lt;th>Global/regional&lt;/th>
&lt;th>Recommended traffic&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Azure Front Door&lt;/td>
&lt;td>Global&lt;/td>
&lt;td>HTTP(S)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Traffic Manager&lt;/td>
&lt;td>Global&lt;/td>
&lt;td>non-HTTP(S)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Application Gateway&lt;/td>
&lt;td>Regional&lt;/td>
&lt;td>HTTP(S)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Azure Load Balancer&lt;/td>
&lt;td>Regional&lt;/td>
&lt;td>non-HTTP(S)&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="choosing-a-load-balancing-option">Choosing a load balancing option&lt;/h2>
&lt;p>&lt;img src="img/load-balancing-decision-tree.png" alt="Load Balancing Decision Tree">&lt;/p></description></item><item><title>AZ-700 Prep Highlights</title><link>/post/2022-06-03-az-700-prep/</link><pubDate>Fri, 03 Jun 2022 06:00:00 +0000</pubDate><guid>/post/2022-06-03-az-700-prep/</guid><description>&lt;blockquote>
&lt;p>Work in progress&lt;/p>
&lt;/blockquote>
&lt;p>This blog post summarizes my notes on my course on az-700: the course teaches Network Engineers how to design, implement, and maintain Azure networking solutions. The course covers the process of designing, implementing, and managing core Azure networking infrastructure, Hybrid Networking connections, load balancing traffic, network routing, private access to Azure services, network security and monitoring.&lt;/p>
&lt;h2 id="virtual-networks">Virtual Networks&lt;/h2>
&lt;h3 id="capabilities">Capabilities&lt;/h3>
&lt;ul>
&lt;li>Communication with the internet&lt;/li>
&lt;li>Communication between Azure resources&lt;/li>
&lt;li>Communication between on-premises resources&lt;/li>
&lt;li>Filtering network traffic&lt;/li>
&lt;li>Routing network traffic&lt;/li>
&lt;/ul>
&lt;h3 id="address-spaces-to-be-used">Address spaces to be used&lt;/h3>
&lt;ul>
&lt;li>10.0.0.0 - 10.255.255.255 (10/8 prefix)&lt;/li>
&lt;li>172.16.0.0 - 172.31.255.255 (172.16/12 prefix)&lt;/li>
&lt;li>192.168.0.0 - 192.168.255.255 (192.168/16 prefix)&lt;/li>
&lt;/ul>
&lt;h3 id="subnets">Subnets&lt;/h3>
&lt;p>Azure reserves 5 IP addresses within each subnet.&lt;/p>
&lt;ul>
&lt;li>x.x.x.0: Network address&lt;/li>
&lt;li>x.x.x.1: Reserved by Azure for the default gateway&lt;/li>
&lt;li>x.x.x.2, x.x.x.3: Reserved by Azure to map the Azure DNS IPs to the VNet space&lt;/li>
&lt;li>x.x.x.255: Network broadcast address&lt;/li>
&lt;/ul>
&lt;h2 id="scopes">Scopes&lt;/h2>
&lt;p>All Azure resource types have a scope that defines the level that resource names must be unique. A resource must have a unique name within its scope. There are four levels you can specify a scope:&lt;/p>
&lt;ul>
&lt;li>Global (Azure Storage Account)&lt;/li>
&lt;li>Management Group&lt;/li>
&lt;li>Subscription&lt;/li>
&lt;li>Resource Group (Azure Virtual Network)&lt;/li>
&lt;li>Resource&lt;/li>
&lt;/ul>
&lt;h2 id="regions-and-subscriptions">Regions and Subscriptions&lt;/h2>
&lt;p>A resource can be created in a virtual network in the same region and subscription but virtual network can be connected from different subscriptions and regions&lt;/p>
&lt;h2 id="availability-zones">Availability Zones&lt;/h2>
&lt;p>An Azure Availability Zone enables you to define unique physical locations within a region. Each zone is made up of one or more data centers equipped with independent power, cooling, and networking. Designed to ensure high-availability of your Azure services, the physical separation of Availability Zones within a region protects applications and data from data center failures.&lt;/p>
&lt;ul>
&lt;li>Zonal services: Resources can be pinned to a specific zone&lt;/li>
&lt;li>Zone-Redundant services: Resources are replicated across zones automatically&lt;/li>
&lt;li>Non-Regional services: services are always available and are resilient to zone-wide and region-wide outages.&lt;/li>
&lt;/ul>
&lt;h2 id="public-ip">Public IP&lt;/h2>
&lt;p>Public IP addresses enable Internet resources to communicate with Azure resources and enable Azure resources to communicate outbound with Internet and public-facing Azure services. A public IP address in Azure is dedicated to a specific resource, until it&amp;rsquo;s unassigned by a network engineer. A resource without a public IP assigned can communicate outbound through network address translation services, where Azure dynamically assigns an available IP address that isn&amp;rsquo;t dedicated to the resource.&lt;/p>
&lt;blockquote>
&lt;ul>
&lt;li>A &lt;strong>dynamic&lt;/strong> public IP address is an assigned address that can change over the lifespan of the Azure resource. The dynamic IP address is allocated when you create or start a VM. The IP address is released when you stop or delete the VM. In each Azure region, public IP addresses are assigned from a unique pool of addresses. The default allocation method is dynamic.&lt;/li>
&lt;li>A &lt;strong>static&lt;/strong> public IP address is an assigned address that will not change over the lifespan of the Azure resource. To ensure that the IP address for the resource remains the same, set the allocation method explicitly to static. In this case, an IP address is assigned immediately. It is released only when you delete the resource or change the IP allocation method to dynamic.&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;blockquote>
&lt;ul>
&lt;li>Basic SKU: can be assigned by using static or dynamic allocation methods, are open by default, use of NSG is recommended but optional for restricting inbound or outbound traffic. Assignable to to any Azure resource that can be assigned a public IP address, such as network interfaces, VPN gateways, application gateways, and internet-facing load balancers. Availability zone scenarios not supported&lt;/li>
&lt;li>Standard SKU: always use the static allocation method, are secure by default and closed to inbound traffic, must explicitly allow inbound traffic by using a NSG. Assignable to network interfaces, Standard public load balancers, application gateways, or VPN gateways. Zone-redundant by default and optionally zonal (they can be created zonal and guaranteed in a specific availability zone).&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;h2 id="dns-resolutions">DNS resolutions&lt;/h2>
&lt;p>Depending on how you use Azure to host IaaS, PaaS, and hybrid solutions, you might need to allow the virtual machines (VMs), and other resources deployed in a virtual network to communicate with each other. Although you can enable communication by using IP addresses, it is much simpler to use names that can be easily remembered, and do not change.&lt;/p>
&lt;p>&lt;img src="img/hybrid-dns-infra.png" alt="DNS Resolution">&lt;/p>
&lt;p>DNS is split into two areas: Public, and Private DNS for resources accessible from your own internal networks.&lt;/p>
&lt;h3 id="public-dns-services">Public DNS Services&lt;/h3>
&lt;p>Public DNS services resolve names and IP addresses for resources and services accessible over the internet such as web servers. Azure DNS is a hosting service for DNS domain that provides name resolution by using Microsoft Azure infrastructure. DNS domains in Azure DNS are hosted on Azure&amp;rsquo;s global network of DNS name servers. Azure DNS uses anycast networking. Each DNS query is answered by the closest available DNS server to provide fast performance and high availability for your domain.&lt;/p>
&lt;p>In Azure DNS, you can create address records manually within relevant zones. The records most frequently used will be:&lt;/p>
&lt;ul>
&lt;li>Host records: A/AAAA (IPv4/IPv6)&lt;/li>
&lt;li>Alias records: CNAME&lt;/li>
&lt;/ul>
&lt;p>Azure DNS provides a reliable, secure DNS service to manage and resolve domain names in a virtual network without needing to add a custom DNS solution.&lt;/p>
&lt;p>A DNS zone hosts the DNS records for a domain. So, to start hosting your domain in Azure DNS, you need to create a DNS zone for that domain name. Each DNS record for your domain is then created inside this DNS zone.&lt;/p>
&lt;p>You do not have to own a domain name to create a DNS zone with that domain name in Azure DNS. However, you do need to own the domain to configure the domain.&lt;/p>
&lt;h3 id="delegate-dns-domains">Delegate DNS Domains&lt;/h3>
&lt;p>To delegate your domain to Azure DNS, you first need to know the name server names for your zone. Each time a DNS zone is created Azure DNS allocates name servers from a pool. Once the Name Servers are assigned, Azure DNS automatically creates authoritative NS records in your zone.&lt;/p>
&lt;p>Once the DNS zone is created, and you have the name servers, you need to update the parent domain. Each registrar has their own DNS management tools to change the name server records for a domain. In the registrar’s DNS management page, edit the NS records and replace the NS records with the ones Azure DNS created.&lt;/p>
&lt;p>Note: When delegating a domain to Azure DNS, you must use the name server names provided by Azure DNS. You should always use all four name server names, regardless of the name of your domain.&lt;/p>
&lt;h3 id="private-dns-services">Private DNS Services&lt;/h3>
&lt;p>Private DNS services resolve names and IP addresses for resources and services&lt;/p>
&lt;p>When resources deployed in virtual networks need to resolve domain names to internal IP addresses, they can use one the three methods:&lt;/p>
&lt;ul>
&lt;li>Azure DNS Private Zones&lt;/li>
&lt;li>Azure-provided name resolution&lt;/li>
&lt;li>Name resolution that uses your own DNS server&lt;/li>
&lt;/ul>
&lt;p>The type of name resolution you use depends on how your resources need to communicate with each other.&lt;/p>
&lt;p>Your name resolution needs might go beyond the features provided by Azure. For example, you might need to use Microsoft Windows Server Active Directory domains, resolve DNS names between virtual networks. To cover these scenarios, Azure provides the ability for you to use your own DNS servers.&lt;/p>
&lt;p>DNS servers within a virtual network can forward DNS queries to the recursive resolvers in Azure. This enables you to resolve host names within that virtual network. For example, a domain controller (DC) running in Azure can respond to DNS queries for its domains and forward all other queries to Azure. Forwarding queries allows VMs to see both your on-premises resources (via the DC) and Azure-provided host names (via the forwarder). Access to the recursive resolvers in Azure is provided via the virtual IP 168.63.129.16.&lt;/p>
&lt;p>DNS forwarding also enables DNS resolution between virtual networks and allows your on-premises machines to resolve Azure-provided host names. In order to resolve a VM&amp;rsquo;s host name, the DNS server VM must reside in the same virtual network and be configured to forward host name queries to Azure. Because the DNS suffix is different in each virtual network, you can use conditional forwarding rules to send DNS queries to the correct virtual network for resolution.&lt;/p>
&lt;h2 id="cross-virtual-network-connectivity-with-peering">Cross-virtual network connectivity with peering&lt;/h2>
&lt;p>Organizations with large scale operations will often need to create connections between different parts of their virtual network infrastructure. Virtual network peering enables you to seamlessly connect separate VNets with optimal network performance, whether they are in the same Azure region (VNet peering) or in different regions (Global VNet peering). Network traffic between peered virtual networks is private. The virtual networks appear as one for connectivity purposes. The traffic between virtual machines in peered virtual networks uses the Microsoft backbone infrastructure, and no public Internet, gateways, or encryption is required in the communication between the virtual networks.&lt;/p>
&lt;p>Virtual network peering enables you to seamlessly connect two Azure virtual networks. Once peered, the virtual networks appear as one, for connectivity purposes. There are two types of VNet peering.&lt;/p>
&lt;ul>
&lt;li>&lt;strong>Regional peering&lt;/strong> connects Azure virtual networks in the same region.&lt;/li>
&lt;li>&lt;strong>Global peering&lt;/strong> connects Azure virtual networks in different regions. When creating a global peering, the peered virtual networks can exist in any Azure public cloud region or China cloud regions, but not in Government cloud regions. You can only peer virtual networks in the same region in Azure Government cloud regions.&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="img/peering.jpg" alt="Peering">&lt;/p>
&lt;p>Benefits:&lt;/p>
&lt;ul>
&lt;li>A low-latency, high-bandwidth connection between resources in different virtual networks.&lt;/li>
&lt;li>The ability to apply network security groups in either virtual network to block access to other virtual networks or subnets.&lt;/li>
&lt;li>The ability to transfer data between virtual networks across Azure subscriptions, Azure Active Directory tenants, deployment models, and Azure regions.&lt;/li>
&lt;li>The ability to peer virtual networks created through the Azure Resource Manager.&lt;/li>
&lt;li>The ability to peer a virtual network created through Resource Manager to one created through the classic deployment model.&lt;/li>
&lt;li>No downtime to resources in either virtual network is required when creating the peering, or after the peering is created.&lt;/li>
&lt;/ul>
&lt;h2 id="gateway-transit">Gateway Transit&lt;/h2>
&lt;p>Is a peering property that lets one virtual network use the VPN gateway in the peered virtual network for cross-premises or VNet-to-VNet connectivity.&lt;/p>
&lt;p>&lt;img src="img/gatewaytransit.png" alt="Gateway Transit">&lt;/p>
&lt;h2 id="traffic-routing">Traffic routing&lt;/h2>
&lt;ul>
&lt;li>System routes&lt;/li>
&lt;li>Default routes&lt;/li>
&lt;li>custom routes&lt;/li>
&lt;/ul>
&lt;p>Default routes&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Source&lt;/th>
&lt;th>Address prefixes&lt;/th>
&lt;th>Next hop type&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Default&lt;/td>
&lt;td>Unique to the virtual network&lt;/td>
&lt;td>Virtual network&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Default&lt;/td>
&lt;td>0.0.0.0/0&lt;/td>
&lt;td>Internet&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Default&lt;/td>
&lt;td>10.0.0.0/8&lt;/td>
&lt;td>None&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Default&lt;/td>
&lt;td>192.168.0.0/16&lt;/td>
&lt;td>None&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Default&lt;/td>
&lt;td>100.64.0.0/10&lt;/td>
&lt;td>None&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table></description></item></channel></rss>